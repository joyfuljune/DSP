# <div align='center'> Lab 2 – LTI系统的系统函数和频率响应</div>

#### 目录
- [实验目的](@实验目的 )
- [实验内容](@实验内容)
  - [差分方程](@差分方程)
   - [例题](@例题)
  - [系统函数H(z)和零极点画图](@系统函数H(z)和零极点画图)
  - [因果稳定性](@因果稳定性)
 
- [练习](@练习)


## 实验目的  
在本实验中，我们将使用MATLAB分析LTI系统中如何用差分方程描述一个系统，根据差分方程所对应的系统函数和频率响应又可以如何通过画图表达。我们将根据系统函数画出零极点图，分析系统的稳定性。

## 实验内容  
### 差分方程  
LTI系统也可以表示为差分方程，如下所示：  

$$\sum_{k=0}^{K} a_{k} y[n-k]=\sum_{m=0}^{M} b_{m} x[n-m]$$  

其中x [n]是系统输入，y [n]是系统输出。 如果x是一个MATLAB向量，在nx≤n≤nx+ Nx-1区间内，并且向量a和b包含系数ak和bm，则<code>filter（b，a，x）</code>指令返回以下输出结果：
$$\sum_{k=0}^{K} a[k+1] y[n-k]=\sum_{m=0}^{M} b[m+1] x[n-m]$$  
b指代x[n]前的系数，a指代y[n]前的系数，例如<code>y[n]+2y[n-1]=x[n]-3x[n]-1</code> 则
b = [1 -3], a = [1 2];
请注意，filter函数的输出结果y[n]包含的样本区间与x的样本区间相同。

### 例题
+ 定义a1和b1来描述如下所示的因果LTI系统：
$$y[n] = 0.5x[n] + x[n - 1] + 2x[n - 2]$$
解：
$$x = [1 2 3 4]; a1 = [1]; b1 = [0.5 1 2]; y1 = filter(b1,a1,x)$$

+ 使用filter函数计算响应y [n]对输入x [n] = nu [n]的结果  
解：
$$x = [1 2 3 4]; a1 = [1 -0.8]; b1 = [2]; y1 = filter(b1,a1,x)$$

### 系统函数H(z)和零极点画图  
双边z变换的公式为

$$ X(z)=\sum_{n=-\infty}^{\infty} x[n] z^{-n}={N(z) \over D(z)} $$  

式中N(z)表示分子，D(z)表示分母，分别可以求出系统的零点和极点。我们可以通过画出零极点图的方法来观察判断系统属性。可以使用函数roots来计算有理系统函数的极点和零点。 roots函数需要将分子分母的系数以z的降序次数的方式排列。 例如，考虑如下LTI系统函数
$$H\left(z\right)=\frac{z^2-z}{z^2+3z+2}$$  
系统的零极点可以通过以下代码得到：
```matlab
b = [1 -1 0] 	%分子系数降序排列
a = [1 3 2] 		%分母系数降序排列
zs = roots(b) 
ps = roots(a) 
```
```matlab
zs   = 0
      1
ps   = -2
      -1
```
通常希望将离散时间系统函数写成是关于z-1的多项式（表示延迟）。这些多项式的系数可以很容易从线性常系数差分方程中获得，也正好对应了之前所提到的filter函数需要的参数。但是，如果分子和分母阶次不同，则z = 0处的某些极点或零点可能会被忽略。 例如，上题可以改写成以下形式
$$H\left(z\right)=\frac{1-z^{-1}}{1+3z^{-1}+2z^{-2}}$$
使用相同的代码，会发现零点z=0的值消失了。
```matlab
zs   = 
      1
ps   = -2
      -1
```

当系统函数以 $z^{-1}$ 的形式出现，为了找到完整的极点和零点，你必须将零附加到低阶多项式的系数向量，使得系数向量的长度相同。 代码修改如下，针对任意系数向量a和b
```matlab
la = length(a);
lb = length(b);
if(la>lb)
  b = [b zeros(1,la-lb)];
elseif (lb > la)
  a = [a zeros(1,lb-la)];
end
ps = roots(a);
zs = roots(b);
```
### 因果稳定性  
对于LTI系统而言，稳定性的判断依赖于单位脉冲响应h[n]
$$\sum_{n=-\infty}^{\infty}{|h\left(n\right)|}<\infty$$
根据h[n]所求的的z变换H(z)其收敛域应包含有单位圆，即|z|=1的情况。
如果LTI系统同时是因果的，则h[n]=0,n<0是一个因果序列，z变换H(z)收敛域应在圆外。
综上而言，一个因果稳定的LTI系统其收敛域应满足|z|≥1，这要求全部极点在单位圆内。

## 练习
<ol>
  <li>针对以下差分方程，分别写出系数向量a和b的值，同时用filter函数求出当x[n]=u[n]，0≤n≤3时系统的响应并将结果画图表示。
    <ol>
      <li> $y[n]=0.5x[n]+x[n-1]+2x[n-2]$ </li>
      <li> $y[n]=0.8y[n-1]+2x[n]$ </li>
      <li> $y[n]-0.8y[n-1]=2x[n-1]$ </li>
    </ol>
  </li>
      
   <li>使用zplane函数将以下系统的零极点图画出来，标明序号。
     <ol>
      <li> $H\left(z\right)=\frac{z^2-z}{z^2+3z+2}$ </li>
      <li> $y\left[n\right]+y\left[n-1\right]+0.5y\left[n-2\right]=x[n] $</li>
      <li> $y[n]-1.25y[n-1]+0.75y[n-2]-0.125y[n-3]=x[n]+0.5x[n-1]$ </li>
     </ol>
   </li>
  
  <li>3.	对于差分方程 $y[n]=ay[n-1]+x[n]$ 
    <ol>
      <li>写一个自定义函数y = diffeqn(a,x,yn1)用于计算上述差分方程所定义的某因果系统。输入参数x表示x[n]序列，0≤n≤N-1，输入参数yn1表示y[-1]的值。输出参数y表示y[n]序列，0≤n≤N-1。新建一个m文件，用下行代码开头并补充具体内容。</li>
      <code> function y = diffeqn(a,x,yn1) </code>
      <li>假设a=1，y[-1]=0，使用a)问中的函数计算x1n=δ[n]，x2[n]=u[n]经过系统的响应。使用stem函数将结果画图。</li>
      <li>假设a=1，y[-1]=0，并且n的取值范围限定在[0,30]，已知有输入x1n=u[n]，x2n=2u[n]，定义输出分别为y1[n]和y2[n]。使用stem函数画出（2y1[n]-y2[n]）的图像。已知该函数是一个线性差分方程，为什么结果不为零？</li>
      <li>由该线性方程描述的因果系统什么时候是稳定的？假设a=0.5，x=u[n]，0≤n≤30，假设y[-1]=0，y[-1]=2两种情况，分别计算y[n]的值，0≤n≤30。使用stem函数将结果画图，两个结果有什么差异？</li>
    </ol>
  </li>  
</ol>






